{% extends "base.html" %}
{% block content %}
<div class="card">
  <div class="subnav">
    <a href="{{ url_for('clientes') }}" class="active">{{ t("Clientes","Clients","客戶") }}</a>
    <a href="{{ url_for('accesos','compras') }}">{{ t("Compras","Purchases","採購") }}</a>
    <a href="{{ url_for('accesos','ventas') }}">{{ t("Ventas","Sales","銷售") }}</a>
    <a href="{{ url_for('accesos','servicios') }}">{{ t("Servicios","Services","服務") }}</a>
  </div>

  <h2>{{ t("Clientes Extranjeros","Foreign Clients","外國客戶") }}</h2>

  {% if clientes %}
  <table>
    <tr>
      <th>{{ t("Empresa","Company","公司") }}</th>
      <th>{{ t("País","Country","國家") }}</th>
      <th>{{ t("Contacto","Contact","聯絡") }}</th>
      <th>{{ t("Teléfono","Phone","電話") }}</th>
      <th>{{ t("Item destacado","Highlighted item","重點項目") }}</th>
      <th>{{ t("Acciones","Actions","操作") }}</th>
    </tr>
    {% for c in clientes %}
    {% set it = (c.items[0] if c.items and c.items|length else None) %}
    <tr>
      <td>{{ c.empresa }}</td>
      <td>{{ c.pais or "Extranjero" }}</td>
      <td>{{ c.email }}</td>
      <td>{{ c.telefono }}</td>
      <td>
        {% if it %}
          <span class="badge">{{ it.tipo|capitalize }}</span>
          {{ it.producto or it.servicio }}
          {% if it.variedad %} • {{ it.variedad }}{% endif %}
          {% if it.cantidad %} • {{ it.cantidad }}{% endif %}
          {% if it.bulto %} {{ it.bulto }}{% endif %}
          {% if it.precio_caja_fmt %} • {{ it.precio_caja_fmt }}{% elif it.precio %} • {{ it.precio }}{% endif %}
        {% else %}
          —
        {% endif %}
      </td>
      <td>
        <a href="{{ url_for('cliente_detalle', username=c.username) }}" class="btn">{{ t("Ver Perfil","View Profile","查看檔案") }}</a>
      </td>
    </tr>
    {% endfor %}
  </table>
  {% else %}
  <p><em>{{ t("No hay clientes registrados aún.","No clients registered yet.","尚未註冊客戶") }}</em></p>
  {% endif %}
</div>
{% endblock %}
