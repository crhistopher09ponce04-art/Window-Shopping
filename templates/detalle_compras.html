{% extends "base.html" %}
{% block content %}
<h2>ğŸ“¥ {{ t("Demandas/Compras", "Purchases/Demands", "éœ€æ±‚/æ¡è³¼") }}</h2>

<form method="GET" class="mt-2">
  <label>{{ t("Buscar", "Search", "æœå°‹") }}</label>
  <input type="text" name="q" value="{{ q or '' }}" placeholder="{{ t('Producto, variedad o empresa...', 'Product, variety or company...', 'ç”¢å“ã€å“ç¨®æˆ–å…¬å¸...') }}">
  <button class="btn" type="submit">{{ t("Filtrar", "Filter", "ç¯©é¸") }}</button>
</form>

<div class="grid mt-2">
  {% for c in data %}
  <div class="card">
    <h3><a href="{{ url_for('empresa', slug=c.slug) }}">{{ c.nombre }}</a></h3>
    <p><span class="badge">{{ c.rol }}</span> â€¢ {{ c.pais }}</p>
    <table class="table">
      <thead>
        <tr>
          <th>{{ t("Producto", "Product", "ç”¢å“") }}</th>
          <th>{{ t("Variedad", "Variety", "å“ç¨®") }}</th>
          <th>{{ t("Calibre", "Size", "è¦æ ¼") }}</th>
          <th>{{ t("Cantidad", "Quantity", "æ•¸é‡") }}</th>
          <th>{{ t("Origen", "Origin", "ç”¢åœ°") }}</th>
          <th>{{ t("Precio", "Price", "åƒ¹æ ¼") }}</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for it in c.items %}
        <tr>
          <td>{{ it.producto }}</td>
          <td>{{ it.variedad or '-' }}</td>
          <td>{{ it.calibre or '-' }}</td>
          <td>{{ it.cantidad }}</td>
          <td>{{ it.origen }}</td>
          <td>{{ it.precio or '-' }}</td>
          <td>
            <form method="POST" action="{{ url_for('cart_add') }}">
              <input type="hidden" name="empresa" value="{{ c.nombre }}">
              <input type="hidden" name="producto" value="{{ it.producto }}">
              <input type="hidden" name="tipo" value="demanda">
              <button type="submit" class="btn">â• {{ t("Agregar","Add","æ·»åŠ ") }}</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% endfor %}
</div>

<a href="{{ url_for('dashboard') }}" class="btn mt-3">â¬…ï¸ {{ t("Volver","Back","è¿”å›") }}</a>
{% endblock %}
