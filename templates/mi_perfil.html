{% extends "base.html" %}
{% block content %}
<h2>Mi Perfil</h2>

<form method="POST" class="card form">
  <label>Nombre</label>
  <input type="text" name="name" value="{{ company['name'] }}">
  <label>Ciudad</label>
  <input type="text" name="city" value="{{ company['city'] }}">
  <label>País</label>
  <input type="text" name="country" value="{{ company['country'] }}">
  <label>Teléfono</label>
  <input type="text" name="phone" value="{{ company['phone'] }}">
  <label>Email</label>
  <input type="email" name="email" value="{{ company['email'] }}">
  <button class="btn btn-primary" type="submit">Guardar cambios</button>
</form>

<section class="card">
  <h3>Publicar nuevo ítem</h3>
  <form method="POST" action="{{ url_for('add_item') }}" class="form">
    <label>Producto/Servicio *</label>
    <input type="text" name="name" required>
    <label>Variedad</label>
    <input type="text" name="variety">
    <div class="row">
      <div>
        <label>Medida</label>
        <select name="measure">
          <option value="kg">Kg</option>
          <option value="tons">Toneladas</option>
          <option value="boxes">Cajas</option>
          <option value="units">Unidades</option>
        </select>
      </div>
      <div>
        <label>Cantidad</label>
        <input type="number" step="0.01" name="quantity" placeholder="0">
      </div>
      <div>
        <label>Precio (CLP)</label>
        <input type="number" step="0.01" name="price" placeholder="0">
      </div>
    </div>
    <label>Notas</label>
    <input type="text" name="notes" placeholder="Detalles adicionales">
    <button class="btn btn-success" type="submit">Agregar ítem</button>
  </form>
</section>

<section class="card">
  <h3>Mis Ítems</h3>
  {% if items %}
  <table>
    <thead>
      <tr><th>Producto</th><th>Variedad</th><th>Cant.</th><th>Medida</th><th>Precio</th><th></th></tr>
    </thead>
    <tbody>
      {% for it in items %}
      <tr>
        <td>{{ it['name'] }}</td>
        <td>{{ it['variety'] }}</td>
        <td>{{ it['quantity'] }}</td>
        <td>{{ it['measure'] }}</td>
        <td>${{ '%.0f'|format(it['price']) }}</td>
        <td>
          <form method="POST" action="{{ url_for('delete_item', item_id=it['id']) }}">
            <button class="btn btn-danger" onclick="return confirm('¿Eliminar ítem?')">Eliminar</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p>No tienes ítems publicados aún.</p>
  {% endif %}
</section>
{% endblock %}
