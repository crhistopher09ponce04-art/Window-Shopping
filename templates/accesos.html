{% extends "base.html" %}
{% block content %}
<h2 class="mt-1">
  {% if tipo=='servicios' %}
    ğŸ§° {{ t("Servicios disponibles", "Available services","å¯ç”¨æœå‹™") }}
  {% elif tipo=='ventas' %}
    ğŸ›’ {{ t("Ofertas/Ventas disponibles", "Available offers/sales","å¯ç”¨ä¾›æ‡‰/éŠ·å”®") }}
  {% else %}
    ğŸ“¥ {{ t("Demandas/Compras disponibles", "Available demands/purchases","å¯ç”¨éœ€æ±‚/æ¡è³¼") }}
  {% endif %}
</h2>

{% if data and data|length>0 %}
  <div class="grid mt-2">
    {% for c in data %}
      <div class="card">
        <h3><a href="{{ url_for('empresa', slug=c.slug) }}">{{ c.nombre }}</a></h3>
        <p class="mt-1"><span class="badge">{{ c.rol }}</span> â€¢ {{ c.pais }}</p>
        <p class="mt-1">{{ c.descripcion }}</p>

        {% if c.items and c.items|length>0 %}
          <table class="table mt-2">
            <thead>
              <tr>
                {% if tipo=='servicios' %}
                  <th>{{ t("Servicio", "Service","æœå‹™") }}</th>
                  <th>{{ t("Capacidad", "Capacity","ç”¢èƒ½") }}</th>
                  <th>{{ t("UbicaciÃ³n", "Location","ä½ç½®") }}</th>
                {% else %}
                  <th>{{ t("Tipo", "Type","é¡åˆ¥") }}</th>
                  <th>{{ t("Producto", "Product","ç”¢å“") }}</th>
                  <th>{{ t("Cantidad", "Quantity","æ•¸é‡") }}</th>
                  <th>{{ t("Origen", "Origin","ä¾†æº") }}</th>
                {% endif %}
                <th></th>
              </tr>
            </thead>
            <tbody>
            {% for it in c.items %}
              <tr>
                {% if tipo=='servicios' %}
                  <td>{{ it.servicio }}</td>
                  <td>{{ it.capacidad }}</td>
                  <td>{{ it.ubicacion }}</td>
                {% else %}
                  <td>{{ it.tipo }}</td>
                  <td>{{ it.producto }}</td>
                  <td>{{ it.cantidad }}</td>
                  <td>{{ it.origen }}</td>
                {% endif %}
                <td style="width:1%;white-space:nowrap;">
                  <form method="POST" action="{{ url_for('cart_add') }}">
                    <input type="hidden" name="empresa" value="{{ c.nombre }}">
                    {% if tipo=='servicios' %}
                      <input type="hidden" name="servicio" value="{{ it.servicio }}">
                      <input type="hidden" name="tipo" value="servicio">
                    {% else %}
                      <input type="hidden" name="producto" value="{{ it.producto }}">
                      <input type="hidden" name="tipo" value="{{ it.tipo }}">
                    {% endif %}
                    <button type="submit" class="btn">{{ t("Agregar", "Add","åŠ å…¥") }}</button>
                  </form>
                </td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
        {% endif %}

        <div class="mt-2">
          <a class="btn btn-secondary" href="{{ url_for('empresa', slug=c.slug) }}">{{ t("Ver perfil", "View profile","æŸ¥çœ‹æª”æ¡ˆ") }}</a>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="card mt-2">
    <p>{{ t("No hay registros disponibles.", "No records available.","æš«ç„¡è³‡æ–™") }}</p>
  </div>
{% endif %}

<a href="{{ url_for('dashboard') }}" class="btn mt-3">â¬…ï¸ {{ t("Volver", "Back","è¿”å›") }}</a>
{% endblock %}
